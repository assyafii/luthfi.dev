<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="Specification : AWS, API Gateway, Serverless, Lambda, RDS, Postman
Lab Topology Step-by-step Create IAM role for allow configuration Create Database table with DynamoDB Create AWS API Gateway service Create Lambda function Testing CRUD with postman Verify A. Create IAM role First step is create IAM role to allow Lambda function to call AWS services, for it you can follow guide bellow :
Login to your AWS console, search and chose IAM menu Choose Roles and create role Choose AWS Services -&amp;gt; Lambda and Next And you can see menu bellow For integrate lambda with RDS &amp;amp; cloudwatch, wee need filter &amp;amp; checklist cloudwatchfullaccess And the last one, search dynamodb and checklist full access permissions Add rolename Verify you already added two roles for it, and create role B." />
<meta name="keywords" content="P4, SDN, Cloud, Openstack, etc." />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="/posts/deploy-crud-using-aws-api-gateway-serverless-lambda-and-dynamodb/" />


    <title>
        
            5. Deploy CRUD using AWS API Gateway, Serverless Lambda and DynamoDB :: M. Luthfi As Syafii 
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.25424a81287dda0fe0e15c0d2e0df95b1d84d2c20a84496978c924ee4be417cb.css">






<meta itemprop="name" content="5. Deploy CRUD using AWS API Gateway, Serverless Lambda and DynamoDB">
<meta itemprop="description" content="Specification : AWS, API Gateway, Serverless, Lambda, RDS, Postman
Lab Topology Step-by-step Create IAM role for allow configuration Create Database table with DynamoDB Create AWS API Gateway service Create Lambda function Testing CRUD with postman Verify A. Create IAM role First step is create IAM role to allow Lambda function to call AWS services, for it you can follow guide bellow :
Login to your AWS console, search and chose IAM menu Choose Roles and create role Choose AWS Services -&gt; Lambda and Next And you can see menu bellow For integrate lambda with RDS &amp; cloudwatch, wee need filter &amp; checklist cloudwatchfullaccess And the last one, search dynamodb and checklist full access permissions Add rolename Verify you already added two roles for it, and create role B."><meta itemprop="datePublished" content="2021-01-02T00:00:00+00:00" />
<meta itemprop="dateModified" content="2021-01-02T00:00:00+00:00" />
<meta itemprop="wordCount" content="999"><meta itemprop="image" content="/"/>
<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="/"/>

<meta name="twitter:title" content="5. Deploy CRUD using AWS API Gateway, Serverless Lambda and DynamoDB"/>
<meta name="twitter:description" content="Specification : AWS, API Gateway, Serverless, Lambda, RDS, Postman
Lab Topology Step-by-step Create IAM role for allow configuration Create Database table with DynamoDB Create AWS API Gateway service Create Lambda function Testing CRUD with postman Verify A. Create IAM role First step is create IAM role to allow Lambda function to call AWS services, for it you can follow guide bellow :
Login to your AWS console, search and chose IAM menu Choose Roles and create role Choose AWS Services -&gt; Lambda and Next And you can see menu bellow For integrate lambda with RDS &amp; cloudwatch, wee need filter &amp; checklist cloudwatchfullaccess And the last one, search dynamodb and checklist full access permissions Add rolename Verify you already added two roles for it, and create role B."/>







    <meta property="article:published_time" content="2021-01-02 00:00:00 &#43;0000 UTC" />






<noscript><img src="https://shynet.tommasopifferi.com/ingress/5bf99fb8-5643-4d56-872b-14aa9b66415b/pixel.gif"></noscript> <script src="https://shynet.tommasopifferi.com/ingress/5bf99fb8-5643-4d56-872b-14aa9b66415b/script.js"></script>

    </head>

    <body class="">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            
            <span class="logo__text">luthfi.dev</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/about">About</a></li><li><a href="/posts">Documentation</a></li><li><a href="/resume">Resume</a></li>
    </ul>
</nav>

                <span class="menu-trigger hidden">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        5 minutes

        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="/posts/deploy-crud-using-aws-api-gateway-serverless-lambda-and-dynamodb/"><ol start="5">
<li>Deploy CRUD using AWS API Gateway, Serverless Lambda and DynamoDB</li>
</ol>
</a>
      </h1>

      

      <div class="post-content">
        <hr>
<blockquote>
<p>Specification : AWS, API Gateway, Serverless, Lambda, RDS, Postman</p>
</blockquote>
<h3 id="lab-topology"><strong>Lab Topology</strong></h3>
<p><img src="./aws-lambda-diagram.png" alt="aws-lambda-diagram"></p>
<p><img src="./aws-lambda-detail.png" alt="aws-lambda-detail"></p>
<p> </p>
<h4 id="step-by-step">Step-by-step</h4>
<ul>
<li>Create IAM role for allow configuration</li>
<li>Create Database table with DynamoDB</li>
<li>Create AWS API Gateway service</li>
<li>Create Lambda function</li>
<li>Testing CRUD with postman</li>
<li>Verify</li>
</ul>
<h4 id="a-create-iam-role">A. Create IAM role</h4>
<p>First step is create IAM role to allow Lambda function to call AWS services, for it you can follow guide bellow :</p>
<ol>
<li>Login to your AWS console, search and chose IAM menu</li>
</ol>
<p><img src="./docs/aws1.png" alt="aws1"></p>
<ol start="2">
<li>Choose <code>Roles</code> and create <code>role</code></li>
</ol>
<p><img src="./docs/aws2.png" alt="aws2"></p>
<ol start="3">
<li>Choose AWS Services -&gt; Lambda and Next</li>
</ol>
<p><img src="./docs/aws3.png" alt="aws3"></p>
<ol start="4">
<li>
<p>And you can see menu bellow
<img src="./docs/aws4.png" alt="aws4"></p>
</li>
<li>
<p>For integrate lambda with RDS &amp; cloudwatch, wee need filter &amp; checklist <code>cloudwatchfullaccess</code>
<img src="./docs/aws5.png" alt="aws5"></p>
</li>
<li>
<p>And the last one, search <code>dynamodb</code> and checklist full access permissions
<img src="./docs/aws6.png" alt="aws6"></p>
</li>
<li>
<p>Add rolename
<img src="./docs/aws7.png" alt="aws7"></p>
</li>
<li>
<p>Verify you already added two roles for it, and create role
<img src="./docs/aws8.png" alt="aws8"></p>
</li>
</ol>
<hr>
<p> </p>
<h4 id="b-create-rds-dynamodb-table">B. Create RDS DynamoDB Table</h4>
<p>Next step we need create database for store data, with step bellow :</p>
<ol>
<li>Choose DynamoDB services</li>
</ol>
<p><img src="./docs/aws9.png" alt="aws9"></p>
<ol start="2">
<li>Choose Dashboard and create <code>Table</code></li>
</ol>
<p><img src="./docs/aws10.png" alt="aws10"></p>
<ol start="3">
<li>Put table name, you can same with our tutorial use <code>food-aws-serverless</code> and put <code>Partition Key</code> with <code>foodId</code> for indexing like bellow, and create table</li>
</ol>
<p><img src="./docs/aws11.png" alt="aws11"></p>
<ol start="4">
<li>You can see table after created</li>
</ol>
<p><img src="./docs/aws12.png" alt="aws12"></p>
<hr>
<p> </p>
<h4 id="c-create-lambda-function">C. Create Lambda Function</h4>
<ol>
<li>After create RDS, next create Lambda function to integrate between API Gateway to RDS DynamoDB</li>
</ol>
<p><img src="./docs/aws13.png" alt="aws13"></p>
<ol start="2">
<li>Choose <code>Functions</code> and <code>create function</code></li>
</ol>
<p><img src="./docs/aws14.png" alt="aws14"></p>
<ol start="3">
<li>And follow function like bellow and create function</li>
</ol>
<p><img src="./docs/aws15.png" alt="aws15"></p>
<p><img src="./docs/aws16.png" alt="aws16"></p>
<ol start="4">
<li>And you can see lambda function has been created, after that we need increase specs of lambda with step bellow. Click <code>configuration &gt; Edit</code>, Increase value of Memory and Storage and save.</li>
</ol>
<p><img src="./docs/aws17.png" alt="aws17">
<img src="./docs/aws18.png" alt="aws18"></p>
<ol start="5">
<li>And <code>Important</code> step is create <code>lambda function</code> for CRUD, choose code &gt; edit lambda_function.py &gt; copas code from bellow &gt; and last deploy</li>
</ol>
<p><img src="./docs/aws19.png" alt="aws19"></p>
<p><code>lambda_function.py</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> boto3
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> json
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> botocore.vendored <span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> custom_encoder <span style="color:#f92672">import</span> CustomEncoder
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> logging
</span></span><span style="display:flex;"><span>logger <span style="color:#f92672">=</span> logging<span style="color:#f92672">.</span>getLogger()
</span></span><span style="display:flex;"><span>logger<span style="color:#f92672">.</span>setLevel(logging<span style="color:#f92672">.</span>INFO)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>dynamodbTableName <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;food-aws-serverless&#39;</span>
</span></span><span style="display:flex;"><span>dynamodb <span style="color:#f92672">=</span> boto3<span style="color:#f92672">.</span>resource(<span style="color:#e6db74">&#39;dynamodb&#39;</span>)
</span></span><span style="display:flex;"><span>table <span style="color:#f92672">=</span> dynamodb<span style="color:#f92672">.</span>Table(dynamodbTableName)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>getMethod <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;GET&#39;</span>
</span></span><span style="display:flex;"><span>postMethod <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;POST&#39;</span>
</span></span><span style="display:flex;"><span>patchMethod <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;PATCH&#39;</span>
</span></span><span style="display:flex;"><span>deleteMethod <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;DELETE&#39;</span>
</span></span><span style="display:flex;"><span>healthPath <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/health&#39;</span>
</span></span><span style="display:flex;"><span>foodPath <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/food&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">lambda_handler</span>(event, context):
</span></span><span style="display:flex;"><span>    logger<span style="color:#f92672">.</span>info(event)
</span></span><span style="display:flex;"><span>    httpMethod <span style="color:#f92672">=</span> event[<span style="color:#e6db74">&#39;httpMethod&#39;</span>]
</span></span><span style="display:flex;"><span>    path <span style="color:#f92672">=</span> event[<span style="color:#e6db74">&#39;path&#39;</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> httpMethod <span style="color:#f92672">==</span> getMethod <span style="color:#f92672">and</span> path <span style="color:#f92672">==</span> healthPath:
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> buildResponse(<span style="color:#ae81ff">200</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> httpMethod <span style="color:#f92672">==</span> getMethod <span style="color:#f92672">and</span> path <span style="color:#f92672">==</span> foodPath:
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> getFood(event[<span style="color:#e6db74">&#39;queryStringParameters&#39;</span>][<span style="color:#e6db74">&#39;foodId&#39;</span>])
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> httpMethod <span style="color:#f92672">==</span> postMethod <span style="color:#f92672">and</span> path <span style="color:#f92672">==</span> foodPath:
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> saveFood(json<span style="color:#f92672">.</span>loads(event[<span style="color:#e6db74">&#39;body&#39;</span>]))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> httpMethod <span style="color:#f92672">==</span> patchMethod <span style="color:#f92672">and</span> path <span style="color:#f92672">==</span> foodPath:
</span></span><span style="display:flex;"><span>        requestBody <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>loads(event[<span style="color:#e6db74">&#39;body&#39;</span>])
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> modifyFood(requestBody[<span style="color:#e6db74">&#39;foodId&#39;</span>], requestBody[<span style="color:#e6db74">&#39;updateKey&#39;</span>], requestBody[<span style="color:#e6db74">&#39;updateValue&#39;</span>])
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> httpMethod <span style="color:#f92672">==</span> deleteMethod <span style="color:#f92672">and</span> path <span style="color:#f92672">==</span> foodPath:
</span></span><span style="display:flex;"><span>        requestBody <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>loads(event[<span style="color:#e6db74">&#39;body&#39;</span>])
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> deleteFood(requestBody[<span style="color:#e6db74">&#39;foodId&#39;</span>])
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> buildResponse(<span style="color:#ae81ff">404</span>, <span style="color:#e6db74">&#39;Sorry, Not Found&#39;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> response
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getFood</span>(foodId):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> table<span style="color:#f92672">.</span>get_item(
</span></span><span style="display:flex;"><span>            Key<span style="color:#f92672">=</span>{
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#39;foodId&#39;</span>: foodId
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;Item&#39;</span> <span style="color:#f92672">in</span> response:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> buildResponse(<span style="color:#ae81ff">200</span>, response[<span style="color:#e6db74">&#39;Item&#39;</span>])
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> buildResponse(<span style="color:#ae81ff">404</span>, {<span style="color:#e6db74">&#39;Message&#39;</span> : <span style="color:#e6db74">&#39;FoodId: </span><span style="color:#e6db74">%s</span><span style="color:#e6db74"> not found&#39;</span> <span style="color:#f92672">%</span> foodId})
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span>:
</span></span><span style="display:flex;"><span>        logger<span style="color:#f92672">.</span>exception(<span style="color:#e6db74">&#39;Do your custom error handling here, I am just gonna log it out there!&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">saveFood</span>(requestBody):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        table<span style="color:#f92672">.</span>put_item(Item<span style="color:#f92672">=</span>requestBody)
</span></span><span style="display:flex;"><span>        body <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;Operation&#39;</span> : <span style="color:#e6db74">&#39;SAVE&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;Message&#39;</span> : <span style="color:#e6db74">&#39;SUCCESS&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;Item&#39;</span> : requestBody
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> buildResponse(<span style="color:#ae81ff">200</span>, body)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span>:
</span></span><span style="display:flex;"><span>        logger<span style="color:#f92672">.</span>exception(<span style="color:#e6db74">&#39;Do your custom error handling here, I am just gonna log it out there!&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">modifyFood</span>(foodId, updateKey, updateValue):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> table<span style="color:#f92672">.</span>update_item(
</span></span><span style="display:flex;"><span>            Key<span style="color:#f92672">=</span>{
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#39;foodId&#39;</span>: foodId
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>            UpdateExpression<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;set </span><span style="color:#e6db74">%s</span><span style="color:#e6db74"> = :value&#39;</span> <span style="color:#f92672">%</span> updateKey,
</span></span><span style="display:flex;"><span>            ExpressionAttributeValues<span style="color:#f92672">=</span>{
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#39;:value&#39;</span>: updateValue
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>            ReturnValues<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;UPDATED_NEW&#39;</span>
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>        body <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;Operation&#39;</span>: <span style="color:#e6db74">&#39;UPDATE&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;Message&#39;</span>: <span style="color:#e6db74">&#39;SUCCESS&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;UpdatedAttrebutes&#39;</span>: response
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> buildResponse(<span style="color:#ae81ff">200</span>, body)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span>:
</span></span><span style="display:flex;"><span>        logger<span style="color:#f92672">.</span>exception(<span style="color:#e6db74">&#39;Do your custom error handling here, I am just gonna log it out there!&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">deleteFood</span>(foodId):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> table<span style="color:#f92672">.</span>delete_item(
</span></span><span style="display:flex;"><span>            Key<span style="color:#f92672">=</span>{
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#39;foodId&#39;</span>: foodId
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>            ReturnValues<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;ALL_OLD&#39;</span>
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>        body <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;Operation&#39;</span>: <span style="color:#e6db74">&#39;DELETE&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;Message&#39;</span>: <span style="color:#e6db74">&#39;SUCCESS&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;UpdatedAttrebutes&#39;</span>: response
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> buildResponse(<span style="color:#ae81ff">200</span>, body)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span>:
</span></span><span style="display:flex;"><span>        logger<span style="color:#f92672">.</span>exception(<span style="color:#e6db74">&#39;Do your custom error handling here, I am just gonna log it out there!&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">buildResponse</span>(statusCode, body<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>):
</span></span><span style="display:flex;"><span>    response <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;statusCode&#39;</span> : statusCode,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;headers&#39;</span> : {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;Content-Type&#39;</span>: <span style="color:#e6db74">&#39;application/json&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;Access-Controll-Allow-Origin&#39;</span>: <span style="color:#e6db74">&#39;*&#39;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> body <span style="color:#f92672">is</span> <span style="color:#f92672">not</span> <span style="color:#66d9ef">None</span>:
</span></span><span style="display:flex;"><span>        response[<span style="color:#e6db74">&#39;body&#39;</span>] <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>dumps(body, cls<span style="color:#f92672">=</span>CustomEncoder)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> response
</span></span></code></pre></div><ol start="6">
<li>And last on is create new file named <code>custom_encoder.py</code> &gt; put code bellow &gt; and <code>deploy</code> again.</li>
</ol>
<p><img src="./docs/aws20.png" alt="aws20"></p>
<p><code>custom_encoder.py</code></p>
<pre tabindex="0"><code>import json
from decimal import Decimal

class CustomEncoder(json.JSONEncoder):
    def default(self, obj):
        if isinstance(obj, Decimal):
            return float(obj)

        return json.JSONEncoder.default(self, obj)
</code></pre><p> </p>
<hr>
<p> </p>
<h4 id="d-create-aws-api-gateway">D. Create AWS API Gateway</h4>
<p>Next is create Rest API gateway, to interact between and user &amp; AWS services, for more you can follow bellow step :</p>
<ol>
<li>Choose <code>AWS API Gateway</code> menu</li>
</ol>
<p><img src="./docs/aws21.png" alt="aws21"></p>
<ol start="2">
<li>Choose <code>Public REST API</code> and <code>build</code></li>
</ol>
<p><img src="./docs/aws22.png" alt="aws22"></p>
<ol start="3">
<li>Click REST &gt; New API and put API name</li>
</ol>
<p><img src="./docs/aws23.png" alt="aws23"></p>
<ol start="4">
<li>And next <code>create Resource</code> for place are API Method, bellow for detail structure :</li>
</ol>
<pre tabindex="0"><code>1. Resource /health
Method GET

2. Resource /food
Method GET, POST, PATCH, DELETE

3. Resource /foods (optional, not important)
Method GET, POST, PATCH, DELETE
</code></pre><p><img src="./docs/aws24.png" alt="aws24"></p>
<ol start="4">
<li>Input <code>Resource name</code>, <code>Resource path</code> and checklist Enable API Gateway</li>
</ol>
<p><img src="./docs/aws25.png" alt="aws25"></p>
<ol start="5">
<li>And create also for /food resource like above</li>
</ol>
<p><img src="./docs/aws27.png" alt="aws27"></p>
<ol start="6">
<li>After create <code>Resource</code>, next create <code>Method</code> for every resource. Click Resource name, for example <code>/health</code> &gt; Create Method</li>
</ol>
<pre tabindex="0"><code>1. Resource /health
Method GET

2. Resource /food
Method GET, POST, PATCH, DELETE

3. Resource /foods (optional, not important)
Method GET, POST, PATCH, DELETE
</code></pre><p><img src="./docs/aws29.png" alt="aws29"></p>
<ol start="7">
<li>Chose Method, for example <code>GET</code> and click OK</li>
</ol>
<p><img src="./docs/aws30.png" alt="aws30"></p>
<ol start="8">
<li>Checklist <code>Lambda Function</code> &gt; Proxy integration &gt; and chose <code>Lambda Function</code> previously created &gt; save</li>
</ol>
<p><img src="./docs/aws31.png" alt="aws31"></p>
<ol start="9">
<li>Click OK for continue, and REPEAT create Method for <code>every resource</code> like it and follow structure</li>
</ol>
<p><img src="./docs/aws32.png" alt="aws32"></p>
<ol start="10">
<li>After all <code>Method and Resource</code> has been created, last step is <code>Deploy API</code> like bellow</li>
</ol>
<p><img src="./docs/aws33.png" alt="aws33"></p>
<ol start="11">
<li>Create new stage name, for example: <code>prod</code>, and finish you already created API Gateway</li>
</ol>
<p><img src="./docs/aws34.png" alt="aws34"></p>
<hr>
<p> </p>
<h4 id="e-testing--verify-crud">E. Testing &amp; Verify CRUD</h4>
<ol>
<li>Before testing, you need download <code>Postman Application</code> for testing API, download on : <a href="https://www.postman.com/downloads/">https://www.postman.com/downloads/</a></li>
<li>First step is copy API Endpoint in APIs menu to access from public internet</li>
</ol>
<p><img src="./docs/aws36.png" alt="aws36"></p>
<h5 id="get-option-health-check">GET Option (Health Check)</h5>
<p>To check API status reached or not, with status 200 OK</p>
<p><img src="./docs/aws37.png" alt="aws37"></p>
<h5 id="post-option">POST Option</h5>
<p>To Put new database to RDS via Json format file (key-value), bellow example to add data :</p>
<pre tabindex="0"><code>{
    &#34;foodId&#34;: &#34;001&#34;,
    &#34;name&#34;: &#34;Banana&#34;,
    &#34;price&#34;: &#34;500&#34;
}
</code></pre><p><img src="./docs/aws38.png" alt="aws38">
<img src="./docs/aws39.png" alt="aws39"></p>
<p>And you can see result success POST in DynamoDB table menu :</p>
<p><img src="./docs/aws40.png" alt="aws40"></p>
<h5 id="delete-option">DELETE Option</h5>
<p>For delete database on RDS you can use delete option with index ID (foodId) like bellow</p>
<p><img src="./docs/aws41.png" alt="aws41"></p>
<p>And you can see after deleted foodId = 002 on RDS Table</p>
<p><img src="./docs/aws42.png" alt="aws42"></p>
<h5 id="get-option">GET Option</h5>
<p>To check detail table by foodId</p>
<p><img src="./docs/aws43.png" alt="aws43"></p>
<h5 id="patch-option">PATCH Option</h5>
<p>Patch you can use for update about value/key, bellow example for update banana price, from 500 to 99999</p>
<p><img src="./docs/aws44.png" alt="aws44">
<img src="./docs/aws45.png" alt="aws45"></p>
<hr>
<p> </p>
<h4 id="reference">Reference</h4>
<ul>
<li>Felix Yu Channel : <a href="https://www.youtube.com/watch?v=9eHh946qTIk&amp;list=LL&amp;index=32&amp;t=159s">https://www.youtube.com/watch?v=9eHh946qTIk&amp;list=LL&amp;index=32&amp;t=159s</a></li>
</ul>

      </div>
    </article>

    <hr />

    <div class="post-info">

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        999 Words
      </p>

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        2021-01-02 07:00 &#43;0700
      </p>
    </div>

    
      <div class="pagination">
        <div class="pagination__title">
          <span class="pagination__title-h"></span>
          <hr />
        </div>

        <div class="pagination__buttons">
          
            <span class="button previous">
              <a href="/posts/5g-cloud-native-simulation-with-open5gs/">
                <span class="button__icon">←</span>
                <span class="button__text">4. 5G Cloud Native Simulation with Open5Gs</span>
              </a>
            </span>
          

          
            <span class="button next">
              <a href="/posts/install-openstack-aio-with-kolla-ansible-in-ubuntu/">
                <span class="button__text">6. Install OpenStack AIO with Kolla-Ansible in Ubuntu</span>
                <span class="button__icon">→</span>
              </a>
            </span>
          
        </div>
      </div>
    


    

  </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2023</span>
            
            <span>Made by <a href="http://gohugo.io">Hugo</a></span>
            </span>
        </div>
    </div>
</footer>
            
        </div>

        



<script type="text/javascript" src="/bundle.min.8ea0ff01dfa3348eb00589f8f586e91fbdd52c123c03a22e5d3989256f0764896b02dc521767fb735d737cb971861f5002c6383ddf7ce653bd99a4b1971b8cda.js" integrity="sha512-jqD/Ad&#43;jNI6wBYn49YbpH73VLBI8A6IuXTmJJW8HZIlrAtxSF2f7c11zfLlxhh9QAsY4Pd985lO9maSxlxuM2g==" crossorigin="anonymous"></script>



    </body>
</html>
